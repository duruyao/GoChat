# Database Design Scheme of GoChat

## 1. USERS Table.

| ID | UUID | NAME | EMAIL | PASSWORD | MAX_ROLE | CREATED_AT |
| :-: | :-: | :-: | :-: | :-: | :-: | :-: |
| 1 |  |  |  |  |  |  |
| 2 |  |  |  |  |  |  |
| 3 |  |  |  |  |  |  |

```sql
CREATE TABLE USERS
(
    ID         INTEGER PRIMARY KEY AUTOINCREMENT,
    UUID       VARCHAR(63) NOT NULL UNIQUE,
    NAME       VARCHAR(63) NOT NULL UNIQUE,
    EMAIL      VARCHAR(255),
    PASSWORD   TEXT CHECK ( MAX_ROLE > 3 OR PASSWORD IS NOT NULL ),
    MAX_ROLE   INTEGER     NOT NULL DEFAULT 4,
    CREATED_AT TIMESTAMP   NOT NULL DEFAULT (DATETIME(CURRENT_TIMESTAMP, 'LOCALTIME'))
);
```

## 2. ROOMS Table.

| ID | UUID | NAME | USER_ID | TOKEN | CREATED_AT |
| :-: | :-: | :-: | :-: | :-: | :-: |
| 1 |  |  |  |  |  |
| 2 |  |  |  |  |  |
| 3 |  |  |  |  |  |

```sql
CREATE TABLE ROOMS
(
    ID         INTEGER PRIMARY KEY AUTOINCREMENT,
    UUID       VARCHAR(63) NOT NULL UNIQUE,
    NAME       VARCHAR(63) NOT NULL UNIQUE,
    USER_ID    INTEGER     NOT NULL,
    TOKEN      TEXT        NOT NULL,
    CREATED_AT TIMESTAMP   NOT NULL DEFAULT (DATETIME(CURRENT_TIMESTAMP, 'LOCALTIME')),
    FOREIGN KEY (USER_ID) REFERENCES USERS (ID)
);
```

## 3. SESSIONS Table.

| ID | UUID | USER_ID | CREATED_AT |
| :-: | :-: | :-: | :-: |
| 1 |  |  |  |
| 2 |  |  |  |
| 3 |  |  |  |

```sql
CREATE TABLE SESSIONS
(
    ID         INTEGER PRIMARY KEY AUTOINCREMENT,
    UUID       VARCHAR(63) NOT NULL UNIQUE,
    USER_ID    INTEGER     NOT NULL,
    CREATED_AT TIMESTAMP   NOT NULL DEFAULT (DATETIME(CURRENT_TIMESTAMP, 'LOCALTIME')),
    FOREIGN KEY (USER_ID) REFERENCES USERS (ID)
);
```

## 4. JOIN_ROOM Table.

| ID | UUID | ROOM_ID | USER_ID | CREATED_AT |
| :-: | :-: | :-: | :-: | :-: |
| 1 |  |  |  |  |
| 2 |  |  |  |  |
| 3 |  |  |  |  |

```sql
CREATE TABLE JOIN_ROOM
(
    ID        INTEGER PRIMARY KEY AUTOINCREMENT,
    UUID      VARCHAR(63) NOT NULL UNIQUE,
    ROOM_ID   INTEGER     NOT NULL,
    USER_ID   INTEGER     NOT NULL,
    JOINED_AT TIMESTAMP   NOT NULL DEFAULT (DATETIME(CURRENT_TIMESTAMP, 'LOCALTIME')),
    FOREIGN KEY (ROOM_ID) REFERENCES ROOMS (ID),
    FOREIGN KEY (USER_ID) REFERENCES USERS (ID)
);
```
